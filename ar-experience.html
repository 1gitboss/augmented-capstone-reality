<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
  <!-- Abena TTS Script -->
  <script src="https://abena.mobobi.com/playground/tts/js/tts-embed.js"></script>
  <script>
    
AFRAME.registerComponent('smooth-position', {
  schema: {
    factor: { type: 'number', default: 0.2 }
  },
  
  init: function() {
    this.targetPosition = new THREE.Vector3();
    this.currentPosition = new THREE.Vector3();
    this.isTracking = false;
    
    // Listen for target found/lost events
    const targetEntity = this.el.closest('[mindar-image-target]');
    if (targetEntity) {
      targetEntity.addEventListener('targetFound', () => {
        this.isTracking = true;
        // Get initial position
        this.targetPosition.copy(this.el.object3D.position);
        this.currentPosition.copy(this.el.object3D.position);
      });
      
      targetEntity.addEventListener('targetLost', () => {
        this.isTracking = false;
      });
    }
  },
  
  tick: function() {
    if (!this.isTracking) return;
    
    // Get the current target position
    this.targetPosition.copy(this.el.object3D.position);
    
    // Apply smoothing
    this.currentPosition.lerp(this.targetPosition, this.data.factor);
    
    // Update the position
    this.el.object3D.position.copy(this.currentPosition);
  }
});
    
    
    
    AFRAME.registerComponent('dynamic-ui', {
  schema: {
    targetIndex: { type: 'int' }
  },
  init: function() {
    const targetIndex = this.data.targetIndex;

    // Assign unique IDs per artwork
    this.titlePanelId = `title-panel-${targetIndex}`;
    this.controlsPanelId = `controls-panel-${targetIndex}`;
    
    // Apply unique IDs
    const titlePanel = this.el.querySelector('.title-panel');
    if (titlePanel) titlePanel.id = this.titlePanelId;

    const controlsPanel = this.el.querySelector('.controls-panel');
    if (controlsPanel) controlsPanel.id = this.controlsPanelId;
  }
});

    
    AFRAME.registerComponent('artwork-info', {
  schema: {
    targetIndex: {type: 'number', default: 0}
  },
  
  init: function () {
    // State for info panel
    this.showingMoreInfo = false;
    
    // Get target index from the mindar-image-target entity
    const targetEl = this.el.closest('[mindar-image-target]');
    if (targetEl) {
      this.data.targetIndex = targetEl.getAttribute('mindar-image-target').targetIndex;
      console.log(`Target index: ${this.data.targetIndex}`);
    }
    
    // Artwork data
    this.artworkData = [
      {
        title: "The Presence",
        artist: "Nana Asomani",
        description: "The Presence is a photography project that explores the relationship between humans and the idea of a 'higher spiritual presence' in our lives. In a country like Ghana which is heavily religious, a lot of people base their decision making on the influence of a 'higher' intangible power which serves as a guide to them.",
        location: "Haatso, Accra",
        inspiration: "It is inspired by the use of the halos in movies and animations to represent spirituality and 'heavenly beings'.",
        created: "2023"
      },
      {
        title: "Otema",
        artist: "Nana Asomani",
        description: "Otema is essentially an ode to my friend Otema (subject of the image) celebrating her strength and growth especially in the tech space.",
        location: "Ridge, Accra",
        inspiration: "The idea was to play with the subject being backlit with natural light through a glass to show strength.",
        created: "2023"
      },
      {
        title: "Reflection",
        artist: "Nana Asomani",
        description: "Reflection explores the need as human being to ponder over life decision and experiences to better shape our existence.",
        location: "Military Range, Teshie, Accra",
        inspiration: "The mirror is the one tool that allows us to literally and metaphorically view ourselves.",
        created: "2023"
      },
      {
        title: "In her void",
        artist: "Nana Asomani",
        description: "In her void highlights the strength of women in a predominantly male dominated society. This sometimes isolate women in decision making however their unique strengths shine through.",
        location: "Osu, Accra",
        inspiration: "The use of contrast and light plays an important part of my photography to evoke emotion and show solitude as seen in this image.",
        created: "2023"
      },
      {
        title: "Wade in Water",
        artist: "Nana Asomani",
        description: "Wade in Water explores the relationship between water and human existence. Since time immemorial, water has played a vital role in the formation of civilization and trade.",
        location: "Weija, Accra",
        inspiration: "My personal love for water and our relationship with it inspired this shoot.",
        created: "2023"
      },
      {
        title: "Beige Tones: Concealed Identity",
        artist: "Nana Asomani",
        description: "This shoot explores the interaction between brown tones and the human physique. In our part of the world, the colour brown plays a pivotal role in our culture from our skin to our landscapes.",
        location: "Military Range, Teshie, Accra",
        inspiration: "The idea simply was to conceal the subject by placing her directly in front of the source of light to create a silhouette.",
        created: "2023"
      },
      {
        title: "Ajabeng",
        artist: "Nana Asomani",
        description: "Ajabeng was shot during a fitting for the collaboration between Ajabeng x Okuntakinte.",
        location: "La, Accra",
        inspiration: "Alignment and symmetrical movement makes for great viewing in any art piece.",
        created: "2023"
      },
      {
        title: "Nsuo mu Nsem",
        artist: "Nana Asomani",
        description: "Nsuo mu Nsem, similar to Wade in water, explores the relationship between humans and water but this touches more on the spiritual impact of the element. This project was in collaboration with another photographer Joseph Awumee.",
        location: "Sakumono, Accra",
        inspiration: "The shot particular draws inspiration to the 1803 Igbo landings where rebellious slaves in their bid to resist slaves marched into water and committed mass suicide.",
        created: "2023"
      },
      {
        title: "Ocean view",
        artist: "Nana Asomani",
        description: "Ocean view is essentially an interplay of light and shadow on the human physique with the ocean serving as a backdrop.",
        location: "Military Range, Teshie, Accra",
        inspiration: "Similar to Wade in Water, my love for water and how it shapes our lives influenced this shoot.",
        created: "2023"
      },
      {
        title: "Extra terrestrial Presence",
        artist: "Nana Asomani",
        description: "Extra terrestrial Presence similar to The Presence tries to explore the idea of life and the 'influence' of external intangible forces be it spiritual, supernatural or even paranormal.",
        location: "North Kaneshie, Accra",
        inspiration: "The ring light is one tool that has started a lot of narratives and carries its own story through the life of its owners.",
        created: "2023"
      },
      {
        title: "Tranquil tones",
        artist: "Nana Asomani",
        description: "Tranquil tones essentially pays homage to nature and how it is an extension of our lives and pays an important role in our existence.",
        location: "Oyarifa, Accra",
        inspiration: "The green and blue tones of this image was inspired by the surrounding nature of the location.",
        created: "2023"
      }
    ];
    
    // Audio narrations for different artworks - populate from the artwork data
    this.narrations = {};
    this.artworkData.forEach((artwork, index) => {
      this.narrations[index] = artwork.description;
    });
    
    // Wait for scene to load
    this.el.sceneEl.addEventListener('loaded', () => { 
      console.log("A-Frame Loaded!");
      
      // Get elements
      const igButton = document.querySelector("#ig-link");
      const webButton = document.querySelector("#web-link");
      const twitterButton = document.querySelector("#twitter-link");
      const youtubeButton = document.querySelector("#youtube-link");
      const audioButton = document.querySelector("#audio-button");
      const infoButton = document.querySelector("#more-info-button");
      const infoPanel = document.querySelector("#expanded-info");
      
      // Set up social media buttons
      this.setupButton(igButton, "https://www.instagram.com/as0maniii/");
      this.setupButton(webButton, "https://nanaasomani.com/");
      this.setupButton(twitterButton, "https://twitter.com/as0mani");
      this.setupButton(youtubeButton, "https://www.behance.net/nanaasomani");
      
      // Set up audio button
      if (audioButton) {
        audioButton.classList.add("clickable");
        audioButton.addEventListener('click', () => {
          console.log("Audio button clicked");
          this.toggleAudio();
        });
      }
      
      // Set up more info button
      if (infoButton && infoPanel) {
        infoButton.classList.add("clickable");
        infoButton.addEventListener('click', () => {
          console.log("More info button clicked");
          this.showingMoreInfo = !this.showingMoreInfo;
          
          // Toggle visibility
          infoPanel.setAttribute('visible', this.showingMoreInfo);
          
          // Change button text
          const infoButtonText = document.querySelector("#more-info-text");
          if (infoButtonText) {
            infoButtonText.setAttribute('value', this.showingMoreInfo ? 'Hide Info' : 'More Info');
          }
        });
      }
      
      // Update artwork info based on target index
      this.updateArtworkInfo();
    });
    
    // Audio state
    this.isPlaying = false;
    this.audioElement = null;
  },
  
  updateArtworkInfo: function() {
    const targetIndex = this.data.targetIndex;
    const artwork = this.artworkData[targetIndex];
    
    if (!artwork) return;
    
    // Update title and artist
    const titleText = document.querySelector("#title-text");
    const artistText = document.querySelector("#artist-text");
    if (titleText) titleText.setAttribute('value', artwork.title);
    if (artistText) artistText.setAttribute('value', `by ${artwork.artist}`);
    
    // Update expanded info
    const locationText = document.querySelector("#location-text");
    const inspirationText = document.querySelector("#inspiration-text");
    const createdText = document.querySelector("#created-text");
    
    if (locationText) locationText.setAttribute('value', `Location: ${artwork.location}`);
    if (inspirationText) inspirationText.setAttribute('value', `Inspiration: ${artwork.inspiration}`);
    if (createdText) createdText.setAttribute('value', `Created: ${artwork.created}`);
  },
  
  setupButton: function(button, url) {
    if (button) {
      button.classList.add("clickable");
      button.addEventListener('click', () => {
        console.log("Button clicked: " + url);
        window.open(url, "_blank");
      });
    }
  },
  
  toggleAudio: function() {
    // Implementation for audio with Abena TTS
    // For now, we'll keep the Speech Synthesis API approach
    // and integrate Abena TTS in the future
    
    // Cancel any currently playing speech
    speechSynthesis.cancel();
    
    // Create audio element if it doesn't exist
    if (!this.audioElement) {
      this.audioElement = new SpeechSynthesisUtterance();
      this.audioElement.lang = 'en-US';
      this.audioElement.onend = () => {
        this.isPlaying = false;
        const audioButtonPic = document.querySelector("#audio-button-pic");
        if (audioButtonPic) audioButtonPic.setAttribute("src", "https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/play%20(1).png?v=1741624616933");
      };
    }
    
    // Get narration based on target index
    const narration = this.narrations[this.data.targetIndex] || "No description available for this artwork.";
    this.audioElement.text = narration;
    
    // Toggle audio state
    this.isPlaying = !this.isPlaying;
    const audioButtonPic = document.querySelector("#audio-button-pic");
    
    if (this.isPlaying) {
      speechSynthesis.speak(this.audioElement);
      if (audioButtonPic) audioButtonPic.setAttribute("src", "https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/pause.png?v=1741624608643");
    } else {
      speechSynthesis.cancel();
      if (audioButtonPic) audioButtonPic.setAttribute("src", "https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/play%20(1).png?v=1741624616933");
    }
  }
});

   AFRAME.registerComponent('mytarget', {
  init: function () {
    let visibilityTimeout = null;
    
    this.el.addEventListener('targetFound', () => {
      console.log("Artwork detected!");
      
      // Clear any hiding timeout
      if (visibilityTimeout) {
        clearTimeout(visibilityTimeout);
        visibilityTimeout = null;
      }
      
      // Show the elements
      document.querySelector("#title-panel").setAttribute("visible", "true");
      document.querySelector("#controls-panel").setAttribute("visible", "true");
      // Hide expanded info by default when target is found
      document.querySelector("#expanded-info").setAttribute("visible", "false");
      
      // Update artwork info
      const artworkInfo = this.el.components['artwork-info'];
      if (artworkInfo) {
        artworkInfo.updateArtworkInfo();
      }
    });
    
    this.el.addEventListener('targetLost', () => {
      console.log("Artwork lost!");
      
      // Add a small delay before hiding to prevent flickering during momentary tracking loss
      visibilityTimeout = setTimeout(() => {
        document.querySelector("#title-panel").setAttribute("visible", "false");
        document.querySelector("#controls-panel").setAttribute("visible", "false");
        document.querySelector("#expanded-info").setAttribute("visible", "false");
      }, 300); // 300ms delay before hiding elements
    });
  }
});
  </script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <a-scene
  mindar-image="imageTargetSrc:https://cdn.glitch.global/efbdd796-2226-4f2d-842a-2b1ca1ca40af/final-targets.mind?v=1742218624812; 
  filterMinCF: 0.1; 
  filterBeta: 1000;  
  missTolerance: 10; 
  warmupTolerance: 10; 
  useSmoothing: true" 
  vr-mode-ui="enabled: false"
  color-space="sRGB"
  renderer="colorManagement: true, physicallyCorrectLights"
  device-orientation-permission-ui="enabled: false"
>
    <!-- Add Cursor for Clicking -->
    <a-camera position="0 0 0" look-controls="enabled: false" cursor="fuse: false; rayOrigin: mouse;" 
              raycaster="far: 10000; objects: .clickable">
    </a-camera>
    
    <!-- Target Images - Creating one for each artwork in the collection -->
    <!-- Target 0: The Presence -->
    <a-entity mindar-image-target="targetIndex: 0" mytarget artwork-info>
      <!-- Dynamic Info Panels will be updated by the artwork-info component -->
      <!-- Title Panel at the Top -->
      <a-entity id="title-panel" position="0 0.8 0" visible="false" smooth-position="factor: 0.1">
        <a-plane width="1.2" height="0.25" color="black" opacity="0.7" radius="0.05"></a-plane>
        <a-text id="title-text" value="The Presence" position="0 0.06 0.01" align="center" color="white" width="1.1" font="kelsonsans"></a-text>
        <a-text id="artist-text" value="by Nana Asomani" position="0 -0.06 0.01" align="center" color="white" width="1.1" font="kelsonsans"></a-text>
      </a-entity>
      
      <!-- Controls Panel at the Bottom -->
      <a-entity id="controls-panel" position="0 -0.8 0" visible="false" smooth-position="factor: 0.1">
        <a-plane width="1.2" height="0.5" color="black" opacity="0.7" radius="0.05"></a-plane>
        
        <!-- Social Media Icons -->
        <a-entity position="-0.25 -0.1 0.01">
          <a-image id="ig-link" class="clickable" 
                 src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/IG.png?v=1740499993566"
                 position="0 0 0" height="0.15" width="0.15">
          </a-image>
          
          <a-image id="web-link" class="clickable" 
                 src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/www.png?v=1741643565189"
                 position="0.2 0 0" height="0.15" width="0.15">
          </a-image>
          
          <a-image id="twitter-link" class="clickable" 
                 src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/twitter%20(1).png?v=1741643436230"
                 position="0.4 0 0" height="0.15" width="0.15">
          </a-image>
          
          <a-image id="youtube-link" class="clickable" 
                 src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/behance(1).png?v=1741643496431"
                 position="0.6 0 0" height="0.15" width="0.15">
          </a-image>
        </a-entity>
        
        <!-- Audio and More Info Buttons -->
        <a-entity position="0 0.1 0.01">
          <!-- Audio Button -->
          <a-entity position="-0.1 0 0">
            <a-plane id="audio-button" class="clickable" color="#34a853" width="0.3" height="0.15" radius="0.05"></a-plane>
            <!-- put play icon here-->
            <a-image id="audio-button-pic" 
                     src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/play%20(1).png?v=1741624616933"
                     position= "0 0 0.01" height="0.15" width="0.15">
            </a-image>
          </a-entity>
          
          <!-- More Info Button -->
          <a-entity position="0.3 0 0">
            <a-plane id="more-info-button" class="clickable" color="#4285f4" width="0.3" height="0.15" radius="0.05"></a-plane>
            
            <a-text id="more-info-text" value="More Info" align="center" position="0 0 0.01" color="white" width="1"></a-text>
          </a-entity>
        </a-entity>
      </a-entity>
      
      <!-- Expanded Info Panel (Initially Hidden) -->
      <a-entity id="expanded-info" position="0 0 0.01" visible="false" smooth-position="factor: 0.1">
        <a-plane width="0.9" height="0.7" color="black" opacity="0.85" radius="0.05"></a-plane>
        <a-text id="location-text" value="Location: Haatso, Accra" 
                position="0 0.25 0.01" 
                align="center" 
                color="white" 
                width="0.8">
        </a-text>
        <a-text id="inspiration-text" value="Inspiration: It is inspired by the use of the halos in movies and animations to represent spirituality and 'heavenly beings'."
                position="0 0 0.01" 
                align="center"
                color="white" 
                width="0.8"
                wrap-count="25">
        </a-text>
        <a-text id="created-text" value="Created: 2023"
                position="0 -0.3 0.01" 
                align="center"
                color="white" 
                width="0.8">
        </a-text>
      </a-entity>
    </a-entity>
    
    <!-- Repeat for other targets (1-10) -->
    <!-- For brevity, we'll just define one more target as an example -->
    <!-- Target 4: Wade in Water -->
    <a-entity mindar-image-target="targetIndex: 4" mytarget artwork-info>
      <!-- The content is the same as above but will be dynamically updated by the artwork-info component -->
      <a-entity id="title-panel" position="0 0.8 0" visible="false" smooth-position="factor: 0.1">
        <a-plane width="1.2" height="0.25" color="black" opacity="0.7" radius="0.05"></a-plane>
        <a-text id="title-text" value="Wade in Water" position="0 0.06 0.01" align="center" color="white" width="1.1" font="kelsonsans"></a-text>
        <a-text id="artist-text" value="by Nana Asomani" position="0 -0.06 0.01" align="center" color="white" width="1.1" font="kelsonsans"></a-text>
      </a-entity>
      
      <a-entity id="controls-panel" position="0 -0.8 0" visible="false" smooth-position="factor: 0.1">
        <a-plane width="1.2" height="0.5" color="black" opacity="0.7" radius="0.05"></a-plane>
        
        <a-entity position="-0.25 -0.1 0.01">
          <a-image id="ig-link" class="clickable" 
                 src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/IG.png?v=1740499993566"
                 position="0 0 0" height="0.15" width="0.15">
          </a-image>
          
          <a-image id="web-link" class="clickable" 
                 src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/www.png?v=1741643565189"
                 position="0.2 0 0" height="0.15" width="0.15">
          </a-image>
          
          <a-image id="twitter-link" class="clickable" 
                 src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/twitter%20(1).png?v=1741643436230"
                 position="0.4 0 0" height="0.15" width="0.15">
          </a-image>
          
          <a-image id="youtube-link" class="clickable" 
                 src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/behance(1).png?v=1741643496431"
                 position="0.6 0 0" height="0.15" width="0.15">
          </a-image>
        </a-entity>
        
        <a-entity position="0 0.1 0.01">
          <a-entity position="-0.1 0 0">
            <a-plane id="audio-button" class="clickable" color="#34a853" width="0.3" height="0.15" radius="0.05"></a-plane>
            <a-image id="audio-button-pic" 
                     src="https://cdn.glitch.global/9b643d33-8eab-444c-bfc4-185db20906b5/play%20(1).png?v=1741624616933"
                     position= "0 0 0.01" height="0.15" width="0.15">
            </a-image>
          </a-entity>
          
          <a-entity position="0.3 0 0">
            <a-plane id="more-info-button" class="clickable" color="#4285f4" width="0.3" height="0.15" radius="0.05"></a-plane>
            <a-text id="more-info-text" value="More Info" align="center" position="0 0 0.01" color="white" width="1"></a-text>
          </a-entity>
        </a-entity>
      </a-entity>
      
      <a-entity id="expanded-info" position="0 0 0.01" visible="false" smooth-position="factor: 0.1">
        <a-plane width="0.9" height="0.7" color="black" opacity="0.85" radius="0.05"></a-plane>
        <a-text id="location-text" value="Location: Weija, Accra" 
                position="0 0.25 0.01" 
                align="center" 
                color="white" 
                width="0.8">
        </a-text>
        <a-text id="inspiration-text" value="Inspiration: My personal love for water and our relationship with it inspired this shoot."
                position="0 0 0.01" 
                align="center"
                color="white" 
                width="0.8"
                wrap-count="25">
        </a-text>
        <a-text id="created-text" value="Created: 2023"
                position="0 -0.3 0.01" 
                align="center"
                color="white" 
                width="0.8">
        </a-text>
      </a-entity>
    </a-entity>
    
    <!-- Similar entities would be created for each artwork target -->
    
  </a-scene>
  
  <!-- Optional: Add Abena TTS initialization if needed -->
  <script>
    // Initialize Abena TTS when available
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof AbenaVoice !== 'undefined') {
        console.log("Initializing Abena TTS...");
        // Any initialization code for Abena TTS would go here
      }
    });
  </script>
</body>
</html>